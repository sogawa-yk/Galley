{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "HearingResult",
  "description": "ヒアリング結果の構造化データ",
  "type": "object",
  "required": ["metadata", "project_overview", "requirements"],
  "properties": {
    "metadata": {
      "type": "object",
      "required": ["hearing_id", "created_at", "version"],
      "properties": {
        "hearing_id": { "type": "string", "format": "uuid" },
        "created_at": { "type": "string", "format": "date-time" },
        "updated_at": { "type": "string", "format": "date-time" },
        "version": { "type": "string", "const": "1.0.0" },
        "status": {
          "type": "string",
          "enum": ["in_progress", "completed"]
        }
      }
    },
    "project_overview": {
      "type": "object",
      "required": ["description"],
      "properties": {
        "description": {
          "type": "string",
          "description": "ユーザーが入力した案件概要の自然言語テキスト"
        },
        "industry": {
          "$ref": "#/definitions/answered_item",
          "description": "業種"
        },
        "project_type": {
          "$ref": "#/definitions/answered_item",
          "description": "案件種別"
        }
      }
    },
    "requirements": {
      "type": "object",
      "properties": {
        "scale": {
          "type": "object",
          "properties": {
            "concurrent_users": { "$ref": "#/definitions/answered_item" },
            "total_users": { "$ref": "#/definitions/answered_item" }
          }
        },
        "traffic": {
          "type": "object",
          "properties": {
            "spike_pattern": { "$ref": "#/definitions/answered_item" },
            "peak_tps": { "$ref": "#/definitions/answered_item" }
          }
        },
        "database": {
          "type": "object",
          "properties": {
            "existing_db": { "$ref": "#/definitions/answered_item" },
            "migration_required": { "$ref": "#/definitions/answered_item" },
            "data_volume": { "$ref": "#/definitions/answered_item" }
          }
        },
        "network": {
          "type": "object",
          "properties": {
            "multi_region": { "$ref": "#/definitions/answered_item" },
            "on_premises_connection": { "$ref": "#/definitions/answered_item" }
          }
        },
        "security": {
          "type": "object",
          "properties": {
            "auth_method": { "$ref": "#/definitions/answered_item" },
            "compliance": { "$ref": "#/definitions/answered_item" }
          }
        },
        "availability": {
          "type": "object",
          "properties": {
            "sla_target": { "$ref": "#/definitions/answered_item" },
            "dr_requirement": { "$ref": "#/definitions/answered_item" },
            "backup_policy": { "$ref": "#/definitions/answered_item" }
          }
        },
        "performance": {
          "type": "object",
          "properties": {
            "latency_requirement": { "$ref": "#/definitions/answered_item" },
            "throughput_requirement": { "$ref": "#/definitions/answered_item" }
          }
        },
        "operations": {
          "type": "object",
          "properties": {
            "monitoring": { "$ref": "#/definitions/answered_item" },
            "log_retention": { "$ref": "#/definitions/answered_item" }
          }
        },
        "budget_schedule": {
          "type": "object",
          "properties": {
            "cost_constraint": { "$ref": "#/definitions/answered_item" },
            "demo_deadline": { "$ref": "#/definitions/answered_item" }
          }
        }
      }
    }
  },
  "definitions": {
    "answered_item": {
      "type": "object",
      "required": ["value", "source"],
      "properties": {
        "value": {
          "description": "回答の値（選択値 or 自由入力テキスト）"
        },
        "source": {
          "type": "string",
          "enum": ["user_selected", "user_free_text", "estimated", "not_answered"],
          "description": "値の出所"
        },
        "estimation": {
          "type": "object",
          "description": "source が estimated の場合のみ",
          "properties": {
            "confidence_label": {
              "type": "string",
              "enum": ["public_reference", "general_estimate"],
              "description": "信頼度ラベル"
            },
            "reasoning": {
              "type": "string",
              "description": "推測の根拠説明"
            },
            "source_info": {
              "type": "string",
              "description": "参照元の情報（URLや公開事例の説明等）"
            }
          }
        }
      }
    }
  }
}
